---
title: "Gov 50 Final Project"
author: "Yunzhi Liu"
description: "My final project - editted Oct13"
output:
  distill::distill_article:
    self_contained: false
---

## Project thoughts

I am going to use the dataset from this study:
#Nicholas D. Anderson, “Introducing the Warring States Japan Battle Data,” International Interactions, Latest articles (2022) https://doi.org/10.1080/03050629.2023.2149514

In my study, I aim to explore the correlation between the intensity of whaling activities and the frequency and nature of conflicts during Japan's Warring States era. 
Whaling, deeply rooted in Japanese culture and economy, might have played a pivotal role in influencing conflicts, particularly in significant whaling ports like Taiji, Owase, Ayukawa, and Wadaura. Drawing from battle datasets of the era, I intend to classify regions based on whaling activity intensity (high, medium, low) and analyze the ensuing conflict patterns. Specifically, my outcome variables will be the count of conflicts and their nature (siege vs. non-siege). 
Leveraging R's ggplot package, I'll visualize the relationship between whaling intensity and conflict frequency, as well as the conflict type. 
Through regression analyses, I'll determine if there's a significant causal link, with a positive coefficient suggesting regions with pronounced whaling activities witnessed more conflicts and vice versa. The nature of these conflicts, whether sieges or otherwise, might further provide insights into the strategic significance of these whaling hubs. 
A consistent pattern in these findings will either support or refute my hypothesis regarding the role of whaling in shaping regional conflicts during the period.

```{r}
library(tidyverse)
library(broom)
library(readr)
WarringStatesJapan_battledataV1 <- read_csv("~/Desktop/harvard/GOV50/final project potential dataset/WSJBData/WarringStatesJapan_battledataV1.csv")
# View(WarringStatesJapan_battledataV1)
```


```{r}
warringstate <- WarringStatesJapan_battledataV1 |>
  filter(!is.na(province), !is.na(region), !is.na(naval))

warringstate$naval <- as.integer(warringstate$naval)

near_shore_provinces <- c("yamashiro", "ise", "harima", "hizen", "kii", "settsu", 
                          "bizen", "aki", "chikuzen", "bingo", "buzen", "nagato", 
                          "suo", "awa1", "izu", "tsushima", "izumo", 
                          "iki", "musashi", "toutoumi", "osumi", "satsuma", "sagami", 
                          "tosa", "houki", "ecchu", "higo", "hyuuga", "sanuki", 
                          "bungo", "iyo", "oki", "noto", "awa2", "awaji", "sado")

inland_provinces <- c("yamato", "tanba", "shinano", "mimasaka", "oumi", "tajima", 
                      "kaga", "kawachi", "mino", "owari", "echizen", "kai", "tango", 
                      "bicchu", "mutsu", "shimotsuke", "izumi", "shimousa", "kazusa", 
                      "kouzuke", "chikugo", "inaba", "hitachi", "echigo", "mikawa", 
                      "iga", "wakasa", "dewa", "iwami", "hida", "suruga")

whaling_provinces <- c("hizen", "satsuma", "osumi", "higo", "hyuuga", "bungo", 
                       "kii", "ise", "izumo", "houki", "tosa", "iyo", "bizen", 
                       "bingo", "aki", "harima", "iki", "tsushima")

```

##$ Descriptive Visualizations
```{r}
warringstate <- warringstate |>
  mutate(
    shore_or_inland = case_when(
    province %in% inland_provinces ~ "inland",
    province %in% near_shore_provinces ~ "near shore"),
    naval_or_land = if_else(naval == 1, "Naval Battle", "Land Battle"))

#number of battles taken place in each year
plot_totalbattlebyyear <- warringstate |>
ggplot(mapping = aes(x = year)) + 
  geom_histogram()
plot_totalbattlebyyear

#number of battles taken place in each region
plot_totalbattlebyregion <- warringstate |>
ggplot(mapping = aes(x = region)) + 
  geom_bar()
plot_totalbattlebyregion

#number of battles taken place in each province (red = inland province, blue = near shore province)
plot_totalbattlebyprovince <- warringstate |>
ggplot(mapping = aes(x = province)) + 
  geom_bar(mapping = aes(fill = shore_or_inland))
plot_totalbattlebyprovince

#number of battles taken place in whaling provinces
plot_whalingbyprovince <- warringstate |>
  filter(province == whaling_provinces) |>
  ggplot(mapping = aes(x = province)) + 
  geom_bar()

plot_whalingbyprovince
```


```{r}
#battles taken place in whaling provinces by province and year
plot_whalingbyprovinceandyear <- warringstate |>
  filter(province == whaling_provinces) |>
ggplot(mapping = aes(x = year, y = province)) +
  geom_point()

plot_whalingbyprovinceandyear

#battles taken place in all whaling provinces by year, and the proportion of naval battles
plot_whalingbyyear <- warringstate |>
  filter(province == whaling_provinces) |>
  group_by(naval_or_land) |>
ggplot(mapping = aes(x = year, fill = naval_or_land)) +
  geom_bar()

plot_whalingbyyear
```

##$ Please ONLY CHECK UNTIL ABOVE! THAT is my FIRST VISUALIZATION! ^^^
EVERYTHING beyong this point is STILL EXPERIMENT!




```{r}
#plot showing provinces where naval wars took place, and the proportion of naval wars among all battles in these places
naval_by_province <- warringstate |>
  group_by(province, naval) |>
  summarize(war_no = n())
naval_by_province
```


```{r}
# plot showing regions where naval wars took place, and the proportion of naval wars among all battles in these places
naval_by_region <- warringstate |>
  group_by(region, naval_or_land) |>
  summarize(war_no2 = n())
naval_by_region

naval_prop_region <- naval_by_region|>
ggplot(mapping = aes(x = region, y = war_no2, fill = naval_or_land)) +
  geom_col(position = "dodge")

naval_prop_region
```
```{r}
#scatterplot across time and space

ggplot(data = warringstate, mapping = aes(x = year, y = province)) +
  geom_point()
```
<!-- warringstate |> -->
<!--   filter(province == naval_battle_provinces) |> -->
<!-- ggplot(mapping = aes(x = year, y = province)) + -->
<!--   geom_point() -->

```{r}
naval_battle <- warringstate |>
  filter(naval == 1)
naval_battle

naval_battle |>
  group_by(year)|>
  summarize(n = n())|>
  ggplot(aes(x = year, y = n)) +
  geom_col()
```


```{r}
naval_battle_provinces <- unique(naval_battle$province)

naval_battle_provinces



naval_province_battle_tibble <- warringstate |>
  filter(province == naval_battle_provinces) |>
  group_by(province, naval_or_land) |>
  summarize(war_count = n())
naval_province_battle_tibble

naval_province_battle_tibble |>
  ggplot(mapping = aes(x = province, y = war_count, fill = naval_or_land)) +
  geom_col(position = "dodge")
```



